# AIOFFICE DB MIGRATIONS POLICY
# Правила:
# 1. Любое изменение схемы БД фиксируется через Alembic revision в db/migrations/versions.
# 2. Ревизии коммитятся в репозиторий вместе с кодом, без ручного редактирования SQL в проде.
# 3. Перед выкладкой в среду выполняется:
#       alembic upgrade head
# 4. Откаты делать только через alembic downgrade <revision> и только осознанно, не править БД руками.
# 5. Версия схемы = текущее состояние head.
# 6. Под prod/dev доступ к БД не хранится в коде. Здесь указан шаблон подключения.

[alembic]
# путь к скриптам миграций Alembic
script_location = db/migrations

# строка подключения sqlalchemy.
# ОБЯЗАТЕЛЬНО переопределяется переменной окружения на реальном хосте/сервисе.
# Формат PostgreSQL:
# postgresql+psycopg2://USER:PASSWORD@HOST:5432/aioffice
sqlalchemy.url = postgresql+psycopg2://USER:PASSWORD@localhost:5432/aioffice

# версия нумеруется Alembic автоматически, руками не трогаем
# truncate names is default, leave it as Alembic drives.

[loggers]
keys = root,sqlalchemy,alembic

[handlers]
keys = console

[formatters]
keys = generic

[logger_root]
level = WARN
handlers = console
qualname =

[logger_sqlalchemy]
level = WARN
handlers = console
qualname = sqlalchemy.engine

[logger_alembic]
level = INFO
handlers = console
qualname = alembic

[handler_console]
class = StreamHandler
args = (sys.stdout,)
level = NOTSET
formatter = generic

[formatter_generic]
format = %(levelname)s %(asctime)s %(name)s %(message)s

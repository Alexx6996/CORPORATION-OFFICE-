# AIOFFICE VERSIONING POLICY (SemVer)

current_version_file: version.txt
format: MAJOR.MINOR.PATCH

- MAJOR:
  - Ломающие изменения.
  - Меняется поведение API/контрактов так, что старый клиент/агент больше не совместим.
  - Требует общения с эксплуатацией и, возможно, миграцию данных, обновлённый DR-план.

- MINOR:
  - Новые фичи без ломающих изменений.
  - Расширяются возможности агентов, добавляются эндпоинты, новые метрики и т.д.
  - Обновление MINOR версии не должно ломать существующий сценарий использования.

- PATCH:
  - Багфиксы, оптимизации, исправления безопасности.
  - Не добавляем новую обязательную поверхность API, не меняем контракт.
  - Пример: закрыли уязвимость, поправили p95 latency, обновили зависимости без изменения логики.

Release flow:
1. Меняем версию в version.txt
2. Формируем релиз-ноты (см. CHANGELOG_TEMPLATE.md) с перечислением:
   - Added
   - Changed
   - Fixed
   - Security
3. Создаём тег вида vMAJOR.MINOR.PATCH в git.
4. CI берёт версию из version.txt, встраивает в Docker-образ (label/тег), прогоняет smoke на staging.

Rules:
- НЕЛЬЗЯ пушить в main без обновления version.txt, если поведение сервиса наружу поменялось.
- PATCH без обновления version.txt запрещён.
